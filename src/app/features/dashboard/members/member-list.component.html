<div class="members-container">
    <div class="page-header">
        <div>
            <h1 class="page-title">الأعضاء</h1>
            <p class="page-subtitle">إدارة قائمة الأعضاء والقادة الكشفيين</p>
        </div>
        <button mat-flat-button color="primary" class="add-btn">
            <mat-icon>add</mat-icon>
            إضافة عضو
        </button>
    </div>

    <mat-card class="table-card">
        <div class="table-toolbar">
            <span class="p-input-icon-left search-input">
                <i class="pi pi-search"></i>
                <input pInputText type="text" [(ngModel)]="searchValue"
                    placeholder="بحث بالاسم، البريد، أو المدينة..." />
            </span>
        </div>

        <p-table [value]="filteredChefs()" [loading]="loading()" [paginator]="true" [rows]="10" selectionMode="single"
            (onRowSelect)="onRowSelect($event.data)" responsiveLayout="scroll" [rowHover]="true">

            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="firstName">الاسم <p-sortIcon field="firstName"></p-sortIcon></th>
                    <th pSortableColumn="city">المدينة <p-sortIcon field="city"></p-sortIcon></th>
                    <th pSortableColumn="primaryCuisine">التخصص <p-sortIcon field="primaryCuisine"></p-sortIcon></th>
                    <th pSortableColumn="availabilityStatus">الحالة <p-sortIcon field="availabilityStatus"></p-sortIcon>
                    </th>
                    <th pSortableColumn="rating">التقييم <p-sortIcon field="rating"></p-sortIcon></th>
                    <th></th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-chef>
                <tr [pSelectableRow]="chef" class="cursor-pointer">
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">{{ chef.firstName.charAt(0) }}</div>
                            <div class="user-info">
                                <span class="user-name">{{ chef.firstName }} {{ chef.lastName }}</span>
                                <span class="user-email">{{ chef.email }}</span>
                            </div>
                        </div>
                    </td>
                    <td>{{ chef.city }}</td>
                    <td><span class="tag">{{ chef.primaryCuisine }}</span></td>
                    <td>
                        <p-badge [value]="chef.statusDisplay"
                            [severity]="getSeverity(chef.availabilityStatus)"></p-badge>
                    </td>
                    <td>
                        <div class="rating">
                            <i class="pi pi-star-fill text-yellow-500"></i>
                            <span>{{ chef.rating }}</span>
                        </div>
                    </td>
                    <td>
                        <button mat-icon-button (click)="$event.stopPropagation(); onRowSelect(chef)">
                            <mat-icon>chevron_left</mat-icon>
                        </button>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="6" class="text-center p-4">لا توجد نتائج مطابقة</td>
                </tr>
            </ng-template>
        </p-table>
    </mat-card>
</div>